import{hasVitePlugins}from"@storybook/builder-vite";import{parse}from"vue-docgen-api";import{createFilter}from"vite";import MagicString from"magic-string";function vueDocgen(){let filter=createFilter(/\.(vue)$/);return{name:"storybook:vue-docgen-plugin",async transform(src,id){if(!filter(id))return;let metaData=await parse(id),metaSource=JSON.stringify(metaData),s=new MagicString(src);return s.append(`;_sfc_main.__docgenInfo = ${metaSource}`),{code:s.toString(),map:s.generateMap({hires:!0,source:id})}}}}var core={builder:"@storybook/builder-vite",renderer:"@storybook/vue3"},viteFinal=async(config,{presets})=>{let{plugins=[]}=config;if(!await hasVitePlugins(plugins,["vite:vue"])){let{default:vue}=await import("@vitejs/plugin-vue");plugins.push(vue())}return plugins.push(vueDocgen()),{...config,plugins,resolve:{...config.resolve,alias:{...config.resolve?.alias,vue:"vue/dist/vue.esm-bundler.js"}}}};export{core,viteFinal};
